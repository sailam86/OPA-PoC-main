{"version":3,"file":"wssPlugin.js","names":["fastifyPlugin","WebSocketDebuggerServer","WebSocketDevClientServer","WebSocketMessageServer","WebSocketEventsServer","HermesInspectorProxy","WebSocketApiServer","WebSocketHMRServer","WebSocketRouter","wssPlugin","instance","options","delegate","router","debuggerServer","devClientServer","messageServer","eventsServer","webSocketMessageServer","hermesInspectorProxy","apiServer","hmrServer","hmr","registerServer","decorate","name"],"sources":["../../../src/plugins/wss/wssPlugin.ts"],"sourcesContent":["import type { FastifyInstance } from 'fastify';\nimport fastifyPlugin from 'fastify-plugin';\nimport type { Server } from '../../types';\nimport { WebSocketDebuggerServer } from './servers/WebSocketDebuggerServer';\nimport { WebSocketDevClientServer } from './servers/WebSocketDevClientServer';\nimport { WebSocketMessageServer } from './servers/WebSocketMessageServer';\nimport { WebSocketEventsServer } from './servers/WebSocketEventsServer';\nimport { HermesInspectorProxy } from './servers/HermesInspectorProxy';\nimport { WebSocketApiServer } from './servers/WebSocketApiServer';\nimport { WebSocketHMRServer } from './servers/WebSocketHMRServer';\nimport { WebSocketRouter } from './WebSocketRouter';\n\ndeclare module 'fastify' {\n  interface FastifyInstance {\n    wss: {\n      debuggerServer: WebSocketDebuggerServer;\n      devClientServer: WebSocketDevClientServer;\n      messageServer: WebSocketMessageServer;\n      eventsServer: WebSocketEventsServer;\n      hermesInspectorProxy: HermesInspectorProxy;\n      apiServer: WebSocketApiServer;\n      hmrServer: WebSocketHMRServer;\n      router: WebSocketRouter;\n    };\n  }\n}\n\nasync function wssPlugin(\n  instance: FastifyInstance,\n  {\n    options,\n    delegate,\n  }: {\n    options: Server.Options;\n    delegate: Server.Delegate;\n  }\n) {\n  const router = new WebSocketRouter(instance);\n\n  const debuggerServer = new WebSocketDebuggerServer(instance);\n  const devClientServer = new WebSocketDevClientServer(instance);\n  const messageServer = new WebSocketMessageServer(instance);\n  const eventsServer = new WebSocketEventsServer(instance, {\n    webSocketMessageServer: messageServer,\n  });\n  const hermesInspectorProxy = new HermesInspectorProxy(instance, options);\n  const apiServer = new WebSocketApiServer(instance);\n  const hmrServer = new WebSocketHMRServer(instance, delegate.hmr);\n\n  router.registerServer(debuggerServer);\n  router.registerServer(devClientServer);\n  router.registerServer(messageServer);\n  router.registerServer(eventsServer);\n  router.registerServer(hermesInspectorProxy);\n  router.registerServer(apiServer);\n  router.registerServer(hmrServer);\n\n  instance.decorate('wss', {\n    debuggerServer,\n    devClientServer,\n    messageServer,\n    eventsServer,\n    hermesInspectorProxy,\n    apiServer,\n    hmrServer,\n    router,\n  });\n}\n\nexport default fastifyPlugin(wssPlugin, {\n  name: 'wss-plugin',\n});\n"],"mappings":"AACA,OAAOA,aAAP,MAA0B,gBAA1B;SAESC,uB;SACAC,wB;SACAC,sB;SACAC,qB;SACAC,oB;SACAC,kB;SACAC,kB;SACAC,e;;AAiBT,eAAeC,SAAf,CACEC,QADF,EAEE;EACEC,OADF;EAEEC;AAFF,CAFF,EASE;EACA,MAAMC,MAAM,GAAG,IAAIL,eAAJ,CAAoBE,QAApB,CAAf;EAEA,MAAMI,cAAc,GAAG,IAAIb,uBAAJ,CAA4BS,QAA5B,CAAvB;EACA,MAAMK,eAAe,GAAG,IAAIb,wBAAJ,CAA6BQ,QAA7B,CAAxB;EACA,MAAMM,aAAa,GAAG,IAAIb,sBAAJ,CAA2BO,QAA3B,CAAtB;EACA,MAAMO,YAAY,GAAG,IAAIb,qBAAJ,CAA0BM,QAA1B,EAAoC;IACvDQ,sBAAsB,EAAEF;EAD+B,CAApC,CAArB;EAGA,MAAMG,oBAAoB,GAAG,IAAId,oBAAJ,CAAyBK,QAAzB,EAAmCC,OAAnC,CAA7B;EACA,MAAMS,SAAS,GAAG,IAAId,kBAAJ,CAAuBI,QAAvB,CAAlB;EACA,MAAMW,SAAS,GAAG,IAAId,kBAAJ,CAAuBG,QAAvB,EAAiCE,QAAQ,CAACU,GAA1C,CAAlB;EAEAT,MAAM,CAACU,cAAP,CAAsBT,cAAtB;EACAD,MAAM,CAACU,cAAP,CAAsBR,eAAtB;EACAF,MAAM,CAACU,cAAP,CAAsBP,aAAtB;EACAH,MAAM,CAACU,cAAP,CAAsBN,YAAtB;EACAJ,MAAM,CAACU,cAAP,CAAsBJ,oBAAtB;EACAN,MAAM,CAACU,cAAP,CAAsBH,SAAtB;EACAP,MAAM,CAACU,cAAP,CAAsBF,SAAtB;EAEAX,QAAQ,CAACc,QAAT,CAAkB,KAAlB,EAAyB;IACvBV,cADuB;IAEvBC,eAFuB;IAGvBC,aAHuB;IAIvBC,YAJuB;IAKvBE,oBALuB;IAMvBC,SANuB;IAOvBC,SAPuB;IAQvBR;EARuB,CAAzB;AAUD;;AAED,eAAeb,aAAa,CAACS,SAAD,EAAY;EACtCgB,IAAI,EAAE;AADgC,CAAZ,CAA5B"}