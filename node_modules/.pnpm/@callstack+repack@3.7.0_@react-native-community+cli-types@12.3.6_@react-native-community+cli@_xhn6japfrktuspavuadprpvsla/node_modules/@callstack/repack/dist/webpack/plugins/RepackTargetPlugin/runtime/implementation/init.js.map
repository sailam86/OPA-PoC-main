{"version":3,"file":"init.js","names":["$chunkId$","$chunkLoadingGlobal$","$globalObject$","$hmrEnabled$","module","exports","repackRuntime","loadScript","loadHotUpdate","shared","__repack__","__webpack_require__","repack","loadScriptCallback","scriptManager","undefined","repackLoadScriptCallback","parentPush","data","chunkIds","i","length","push","chunkLoadingGlobal","bind","repackScriptStartup","startupFunctions","x","startupFunction","results","apply","arguments","Object","defineProperty","get","set","fn","name","caller","done","then","catch","reason","console","error","type","target","src","url","fetch","response","ok","statusText","text","script","globalEvalWithSourceUrl","self","eval","call"],"sources":["../../../../../../src/webpack/plugins/RepackTargetPlugin/runtime/implementation/init.ts"],"sourcesContent":["/* eslint-disable no-restricted-globals */\n/* eslint-disable @typescript-eslint/prefer-optional-chain */\n/* eslint-disable promise/prefer-await-to-then */\n/* eslint-disable promise/no-callback-in-promise */\n/* eslint-env browser */\n/* global LoadScriptEvent RepackRuntime __webpack_require__ */\n\nconst $chunkId$ = '';\nconst $chunkLoadingGlobal$ = '';\nconst $globalObject$ = {} as Record<string, any>;\nconst $hmrEnabled$ = false;\n\nmodule.exports = function () {\n  var repackRuntime: RepackRuntime = {\n    loadScript,\n    loadHotUpdate,\n    shared: ($globalObject$.__repack__ && $globalObject$.__repack__.shared) ||\n      (__webpack_require__.repack && __webpack_require__.repack.shared) || {\n        loadScriptCallback: [],\n        scriptManager: undefined,\n      },\n  };\n\n  __webpack_require__.repack = $globalObject$.__repack__ = repackRuntime;\n\n  (function () {\n    function repackLoadScriptCallback(\n      parentPush: (data: string) => void,\n      data: string\n    ) {\n      if (parentPush) {\n        parentPush(data);\n      }\n      var chunkIds = data[0];\n      var i = 0;\n      for (; i < chunkIds.length; i++) {\n        repackRuntime.shared.loadScriptCallback.push([chunkIds[i], $chunkId$]);\n      }\n    }\n\n    var chunkLoadingGlobal = ($globalObject$[$chunkLoadingGlobal$] =\n      $globalObject$[$chunkLoadingGlobal$] || []);\n    chunkLoadingGlobal.push = repackLoadScriptCallback.bind(\n      null,\n      chunkLoadingGlobal.push.bind(chunkLoadingGlobal)\n    );\n  })();\n\n  (function () {\n    function repackScriptStartup() {\n      repackRuntime.shared.loadScriptCallback.push([$chunkId$]);\n    }\n\n    var startupFunctions: Function[] = __webpack_require__.x\n      ? [__webpack_require__.x, repackScriptStartup]\n      : [repackScriptStartup];\n\n    function startupFunction(this: any) {\n      var results;\n      for (var i = 0; i < startupFunctions.length; i++) {\n        results = startupFunctions[i].apply(this, arguments);\n      }\n      return results;\n    }\n\n    Object.defineProperty(__webpack_require__, 'x', {\n      get() {\n        return startupFunction;\n      },\n      set(fn) {\n        startupFunctions.push(fn);\n      },\n    });\n  })();\n\n  function loadScript(\n    name: string,\n    caller: string | undefined,\n    done: (event?: LoadScriptEvent) => void\n  ) {\n    if (repackRuntime.shared.scriptManager) {\n      repackRuntime.shared.scriptManager\n        .loadScript(name, caller, __webpack_require__)\n        .then(function () {\n          done();\n          return;\n        })\n        .catch(function (reason) {\n          console.error('[RepackRuntime] Loading script failed:', reason);\n          done({ type: 'exec', target: { src: name } });\n        });\n    } else {\n      console.error('[RepackRuntime] Script manager was not provided');\n      done({ type: 'exec', target: { src: name } });\n    }\n  }\n\n  function loadHotUpdate(url: string, done: (event?: LoadScriptEvent) => void) {\n    if (!$hmrEnabled$) {\n      console.error('[RepackRuntime] Loading HMR update chunks is disabled');\n      done({ type: 'disabled', target: { src: url } });\n      return;\n    }\n\n    (\n      fetch(url).then(function (response) {\n        if (!response.ok) {\n          console.error(\n            '[RepackRuntime] Loading HMR update failed:',\n            response.statusText\n          );\n          done({ type: response.statusText, target: { src: url } });\n          return;\n        }\n\n        return response.text();\n      }) as Promise<string | undefined>\n    )\n      .then(function (script?: string) {\n        if (script) {\n          // @ts-ignore\n          const globalEvalWithSourceUrl = self.globalEvalWithSourceUrl;\n          (function () {\n            if (globalEvalWithSourceUrl) {\n              globalEvalWithSourceUrl(script, null);\n            } else {\n              eval(script);\n            }\n          }.call(self));\n          done();\n        }\n\n        return;\n      })\n      .catch(function (reason) {\n        console.error(\n          '[RepackRuntime] Loading HMR update chunk failed:',\n          reason\n        );\n        done({ type: 'exec', target: { src: url } });\n      });\n  }\n};\n"],"mappings":"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"}