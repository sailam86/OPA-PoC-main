{"version":3,"file":"convertToRemoteAssets.js","names":["convertToRemoteAssets","assets","assetsDirname","remotePublicPath","resourceDirname","resourceExtensionType","resourceFilename","resourcePath","suffixPattern","pathSeparatorRegexp","assetPath","path","join","replace","publicPathURL","URL","size","getImageSize","asset","JSON","stringify","name","type","httpServerLocation","href","scales","map","scale","height","width","dedent"],"sources":["../../../../src/webpack/loaders/assetsLoader/convertToRemoteAssets.ts"],"sourcesContent":["import path from 'path';\nimport dedent from 'dedent';\nimport { getImageSize } from './utils';\nimport type { Asset } from './types';\n\nexport function convertToRemoteAssets({\n  assets,\n  assetsDirname,\n  remotePublicPath,\n  resourceDirname,\n  resourceExtensionType,\n  resourceFilename,\n  resourcePath,\n  suffixPattern,\n  pathSeparatorRegexp,\n}: {\n  assets: Asset[];\n  assetsDirname: string;\n  remotePublicPath: string;\n  resourceDirname: string;\n  resourceExtensionType: string;\n  resourceFilename: string;\n  resourcePath: string;\n  suffixPattern: string;\n  pathSeparatorRegexp: RegExp;\n}) {\n  const assetPath = path\n    .join(assetsDirname, resourceDirname)\n    .replace(pathSeparatorRegexp, '/');\n\n  // works on both unix & windows\n  const publicPathURL = new URL(path.join(remotePublicPath, assetPath));\n\n  const size = getImageSize({ resourcePath, resourceFilename, suffixPattern });\n\n  const asset = JSON.stringify({\n    name: resourceFilename,\n    type: resourceExtensionType,\n    httpServerLocation: publicPathURL.href,\n    scales: assets.map((asset) => asset.scale),\n    height: size?.height,\n    width: size?.width,\n  });\n\n  return dedent`\n    var AssetSourceResolver = require('react-native/Libraries/Image/AssetSourceResolver');\n    var resolver = new AssetSourceResolver(undefined, undefined, ${asset});\n\n    module.exports = resolver.scaledAssetPath();\n  `;\n}\n"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;AAGO,SAASA,qBAAT,CAA+B;EACpCC,MADoC;EAEpCC,aAFoC;EAGpCC,gBAHoC;EAIpCC,eAJoC;EAKpCC,qBALoC;EAMpCC,gBANoC;EAOpCC,YAPoC;EAQpCC,aARoC;EASpCC;AAToC,CAA/B,EAoBJ;EACD,MAAMC,SAAS,GAAGC,aAAA,CACfC,IADe,CACVV,aADU,EACKE,eADL,EAEfS,OAFe,CAEPJ,mBAFO,EAEc,GAFd,CAAlB,CADC,CAKD;;;EACA,MAAMK,aAAa,GAAG,IAAIC,GAAJ,CAAQJ,aAAA,CAAKC,IAAL,CAAUT,gBAAV,EAA4BO,SAA5B,CAAR,CAAtB;EAEA,MAAMM,IAAI,GAAG,IAAAC,mBAAA,EAAa;IAAEV,YAAF;IAAgBD,gBAAhB;IAAkCE;EAAlC,CAAb,CAAb;EAEA,MAAMU,KAAK,GAAGC,IAAI,CAACC,SAAL,CAAe;IAC3BC,IAAI,EAAEf,gBADqB;IAE3BgB,IAAI,EAAEjB,qBAFqB;IAG3BkB,kBAAkB,EAAET,aAAa,CAACU,IAHP;IAI3BC,MAAM,EAAExB,MAAM,CAACyB,GAAP,CAAYR,KAAD,IAAWA,KAAK,CAACS,KAA5B,CAJmB;IAK3BC,MAAM,EAAEZ,IAAF,aAAEA,IAAF,uBAAEA,IAAI,CAAEY,MALa;IAM3BC,KAAK,EAAEb,IAAF,aAAEA,IAAF,uBAAEA,IAAI,CAAEa;EANc,CAAf,CAAd;EASA,OAAO,IAAAC,eAAA,CAAO;AAChB;AACA,mEAAmEZ,KAAM;AACzE;AACA;AACA,GALE;AAMD"}