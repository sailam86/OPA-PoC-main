{"version":3,"file":"AuxiliaryAssetsCopyProcessor.js","names":["AuxiliaryAssetsCopyProcessor","queue","constructor","config","filesystem","fs","copyAsset","from","to","logger","debug","ensureDir","path","dirname","copyFile","enqueueAsset","asset","outputPath","assetsDest","push","join","execute","map","work"],"sources":["../../../../src/webpack/plugins/utils/AuxiliaryAssetsCopyProcessor.ts"],"sourcesContent":["import path from 'path';\nimport fs from 'fs-extra';\nimport { WebpackLogger } from '../../../types';\n\nexport class AuxiliaryAssetsCopyProcessor {\n  queue: Array<() => Promise<void>> = [];\n\n  constructor(\n    public readonly config: {\n      platform: string;\n      outputPath: string;\n      assetsDest: string;\n      logger: WebpackLogger;\n    },\n    private filesystem: Pick<\n      typeof fs,\n      'ensureDir' | 'copyFile' | 'readFile' | 'writeFile'\n    > = fs\n  ) {}\n\n  private async copyAsset(from: string, to: string) {\n    this.config.logger.debug('Copying asset:', from, 'to:', to);\n    await this.filesystem.ensureDir(path.dirname(to));\n    await this.filesystem.copyFile(from, to);\n  }\n\n  enqueueAsset(asset: string) {\n    const { outputPath, assetsDest } = this.config;\n\n    this.queue.push(() =>\n      this.copyAsset(path.join(outputPath, asset), path.join(assetsDest, asset))\n    );\n  }\n\n  execute() {\n    const queue = this.queue;\n    this.queue = [];\n    return queue.map((work) => work());\n  }\n}\n"],"mappings":";;;;;;;AAAA;;AACA;;;;AAGO,MAAMA,4BAAN,CAAmC;EACxCC,KAAK,GAA+B,EAA/B;;EAELC,WAAW,CACOC,MADP,EAODC,UAGP,GAAGC,gBAVK,EAWT;IAAA,KAVgBF,MAUhB,GAVgBA,MAUhB;IAAA,KAJQC,UAIR,GAJQA,UAIR;EAAE;;EAEmB,MAATE,SAAS,CAACC,IAAD,EAAeC,EAAf,EAA2B;IAChD,KAAKL,MAAL,CAAYM,MAAZ,CAAmBC,KAAnB,CAAyB,gBAAzB,EAA2CH,IAA3C,EAAiD,KAAjD,EAAwDC,EAAxD;IACA,MAAM,KAAKJ,UAAL,CAAgBO,SAAhB,CAA0BC,aAAA,CAAKC,OAAL,CAAaL,EAAb,CAA1B,CAAN;IACA,MAAM,KAAKJ,UAAL,CAAgBU,QAAhB,CAAyBP,IAAzB,EAA+BC,EAA/B,CAAN;EACD;;EAEDO,YAAY,CAACC,KAAD,EAAgB;IAC1B,MAAM;MAAEC,UAAF;MAAcC;IAAd,IAA6B,KAAKf,MAAxC;IAEA,KAAKF,KAAL,CAAWkB,IAAX,CAAgB,MACd,KAAKb,SAAL,CAAeM,aAAA,CAAKQ,IAAL,CAAUH,UAAV,EAAsBD,KAAtB,CAAf,EAA6CJ,aAAA,CAAKQ,IAAL,CAAUF,UAAV,EAAsBF,KAAtB,CAA7C,CADF;EAGD;;EAEDK,OAAO,GAAG;IACR,MAAMpB,KAAK,GAAG,KAAKA,KAAnB;IACA,KAAKA,KAAL,GAAa,EAAb;IACA,OAAOA,KAAK,CAACqB,GAAN,CAAWC,IAAD,IAAUA,IAAI,EAAxB,CAAP;EACD;;AAlCuC"}