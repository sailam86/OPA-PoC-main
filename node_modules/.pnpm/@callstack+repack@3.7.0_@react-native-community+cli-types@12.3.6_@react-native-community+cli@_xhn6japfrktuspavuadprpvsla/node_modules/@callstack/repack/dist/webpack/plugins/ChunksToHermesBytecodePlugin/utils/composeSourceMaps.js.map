{"version":3,"file":"composeSourceMaps.js","names":["composeSourceMaps","reactNativePath","packagerMapPath","compilerMapPath","composedSourceMapPath","execa","path","join","fs","unlink","rename","error","message","toString","Error"],"sources":["../../../../../src/webpack/plugins/ChunksToHermesBytecodePlugin/utils/composeSourceMaps.ts"],"sourcesContent":["import path from 'path';\nimport fs from 'fs-extra';\nimport execa from 'execa';\n\n/**\n * {@link composeSourceMaps} options.\n */\ninterface ComposeSourceMapsOptions {\n  /** Path to the React Native root directory. */\n  reactNativePath: string;\n\n  /**\n   * Path to the source map generated by webpack-bundle.\n   *\n   * This will be replaced with the composed source map.\n   */\n  packagerMapPath: string;\n\n  /** Path to React-Native package inside node_modules. */\n  compilerMapPath: string;\n}\n\n/**\n * Composes source maps generated by webpack-bundle and Hermes.\n *\n * Removes original source map files.\n */\nexport const composeSourceMaps = async ({\n  reactNativePath,\n  packagerMapPath,\n  compilerMapPath,\n}: ComposeSourceMapsOptions) => {\n  const composedSourceMapPath = packagerMapPath + '.composed';\n\n  try {\n    await execa('node', [\n      path.join(reactNativePath, 'scripts/compose-source-maps.js'),\n      packagerMapPath,\n      compilerMapPath,\n      '-o',\n      composedSourceMapPath,\n    ]);\n\n    // Remove intermediate files\n    await fs.unlink(packagerMapPath);\n    await fs.unlink(compilerMapPath);\n\n    await fs.rename(composedSourceMapPath, packagerMapPath);\n  } catch (error) {\n    const message = (error as Error).toString();\n    throw new Error(\n      `ChunksToHermesBytecodePlugin: Failed to compose source maps. Reason:\\n${message})`\n    );\n  }\n};\n"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;AAoBA;AACA;AACA;AACA;AACA;AACO,MAAMA,iBAAiB,GAAG,OAAO;EACtCC,eADsC;EAEtCC,eAFsC;EAGtCC;AAHsC,CAAP,KAID;EAC9B,MAAMC,qBAAqB,GAAGF,eAAe,GAAG,WAAhD;;EAEA,IAAI;IACF,MAAM,IAAAG,cAAA,EAAM,MAAN,EAAc,CAClBC,aAAA,CAAKC,IAAL,CAAUN,eAAV,EAA2B,gCAA3B,CADkB,EAElBC,eAFkB,EAGlBC,eAHkB,EAIlB,IAJkB,EAKlBC,qBALkB,CAAd,CAAN,CADE,CASF;;IACA,MAAMI,gBAAA,CAAGC,MAAH,CAAUP,eAAV,CAAN;IACA,MAAMM,gBAAA,CAAGC,MAAH,CAAUN,eAAV,CAAN;IAEA,MAAMK,gBAAA,CAAGE,MAAH,CAAUN,qBAAV,EAAiCF,eAAjC,CAAN;EACD,CAdD,CAcE,OAAOS,KAAP,EAAc;IACd,MAAMC,OAAO,GAAID,KAAD,CAAiBE,QAAjB,EAAhB;IACA,MAAM,IAAIC,KAAJ,CACH,yEAAwEF,OAAQ,GAD7E,CAAN;EAGD;AACF,CA3BM"}